<section class="container container-md">
  <div class="row">
    <div class="col sm-6">
      <div class="filter-widget border border-2 padding margin">
        <h4 class="filter-widget-title margin-small">Filter</h4>
        <input
          type="search"
          name="filter"
          placeholder="Search for task here"
          [(ngModel)]="filter"
        />
        <h4 class="filter-widget-title margin-small">Sort by</h4>
        <fieldset class="form-group row flex-middle flex-spaces">
          <label for="Priority" class="paper-radio">
            <input
              type="radio"
              name="paperRadios"
              id="Priority"
              [(ngModel)]="sortBy"
              value="priority"
            />
            <span>Priority</span>
          </label>
          <label for="Date" class="paper-radio">
            <input
              type="radio"
              name="paperRadios"
              id="Date"
              [(ngModel)]="sortBy"
              value="date"
            />
            <span>Date</span>
          </label>
          <label for="noSort" class="paper-radio">
            <input
              type="radio"
              name="paperRadios"
              id="noSort"
              [(ngModel)]="sortBy"
              value=""
            />
            <span>Don't Sort</span>
          </label>
        </fieldset>
      </div>
      <app-task-add />
      <hr class="margin" />
      @if (taskForm.id !== "") {
        <section class="border border-3 padding">
          <h4 class="margin-none">Edit Task</h4>
          <form (ngSubmit)="onSubmit(myForm)" #myForm="ngForm">
            <div class="form-group">
              <select
                id="priority"
                name="priority"
                [(ngModel)]="taskForm.priority"
              >
                @for (p of [1, 2, 3, 4]; track $index) {
                  <option [value]="p">Priority {{ p }}</option>
                }
              </select>
            </div>
            <div class="form-group">
              <input
                required
                type="text"
                name="content"
                [(ngModel)]="taskForm.content"
              />
            </div>
            <div class="form-group margin-top-small">
              <button type="submit" [disabled]="myForm.invalid">Send</button>
            </div>
          </form>
          <button (click)="clearEdit()" class="paper-btn btn-block">
            Cancel Edit
          </button>
        </section>
      }
    </div>
    <div class="col sm-6">
      @if (todolist().length > 0) {
        <h4 class="margin-small">Remember to</h4>
        @for (todo of todolist(); track id; let id = $index) {
          <div class="border padding-small margin-small">
            @if (taskDetails() === todo.id) {
              <p>Priority: P{{ todo.priority }}</p>
              <p>NÂº: {{ todo.id }}</p>
              <p>Content: {{ todo.content }}</p>
              <p>Created at: {{ todo.createdAt | date : 'short'  }}</p>
              <p>
                Go to task: <a [routerLink]="todo.url">{{ todo.url }}</a>
              </p>
            } @else {
              <p>{{ todo.content }}</p>
            }
            <div class="row">
              @if (taskDetails() === todo.id) {
                <button (click)="hideDetails()" class="paper-btn btn-small">
                  Show Less
                </button>
              } @else {
                <button
                  (click)="showMoreDetails(todo.id)"
                  class="paper-btn btn-small"
                >
                  Show More
                </button>
              }
              <button class="paper-btn btn-small" (click)="editTask(todo)">
                Live Edit
              </button>
              <button class="paper-btn btn-small" (click)="completeTask(id)">
                Done
              </button>
            </div>
          </div>
        }
      } @else if (todolist().length === 0 && filter() !== "") {
        <p>No Tasks found!</p>
      } @else {
        <p>Loading...</p>
      }
    </div>
  </div>
</section>
